!function(e){"use strict";var t,i,n,o,a,l,s=function(){function t(){i={locale:"en",format:"L LTS",minView:"month",maxView:"month",startView:"month",today:!1,autoclose:!0,leftArrow:"&larr;",rightArrow:"&rarr;",yearsFormat:"YYYY",monthsFormat:"MMM",daysFormat:"D",hoursFormat:"HH:[00]",secondsFormat:"ss",minutesStep:5,secondsStep:1}}var i;return t.prototype.options=function(t){return e.extend(i,t),e.copy(i)},t.prototype.$get=function(){return i},t}(),r=function(){function s(e){var t,i,n,o;if(e)return e.getClientRects().length?(n=e.getBoundingClientRect(),n.width||n.height?(o=e.ownerDocument,i=null!=o&&o===o.window?e:9===o.nodeType&&o.defaultView,t=o.documentElement,{top:n.top+i.pageYOffset-t.clientTop,left:n.left+i.pageXOffset-t.clientLeft}):n):{top:0,left:0}}function r(e,s,r,c,m,d){this.restrict="A",this.scope={model:"=momentPicker",locale:"@?",format:"@?",minView:"@?",maxView:"@?",startView:"@?",minDate:"=?",maxDate:"=?",today:"=?",disabled:"=?disable",autoclose:"=?",change:"&?"},t=e,i=s,n=r,o=c,a=m,l=d}return r.prototype.$inject=["$timeout","$sce","$compile","$document","$window","momentPicker"],r.prototype.link=function(r,c,m){r.template='<div class="moment-picker-container {{view.selected}}-view" ng-show="view.isOpen && !disabled" ng-class="{\'moment-picker-disabled\': disabled, \'open\': view.isOpen}"><table class="header-view"><thead><tr><th ng-class="{disabled: !view.previous.selectable}" ng-bind-html="view.previous.label" ng-click="view.previous.set()"></th><th ng-bind="view.title" ng-click="view.setParentView()"></th><th ng-class="{disabled: !view.next.selectable}" ng-bind-html="view.next.label" ng-click="view.next.set()"></th></tr></thead></table><div class="moment-picker-specific-views"><table ng-if="view.selected == \'month\'"><thead><tr><th ng-repeat="day in monthView.days" ng-bind="day"></th></tr></thead><tbody><tr ng-repeat="days in monthView.weeks"><td ng-repeat="day in days track by day.date" ng-class="day.class" ng-bind="day.label" ng-click="monthView.setDate(day)"></td></tr></tbody></table></div></div>',e.forEach(["locale","format","minView","maxView","startView","today","leftArrow","rightArrow","autoclose"],function(t){e.isDefined(r[t])||(r[t]=l[t]),e.isDefined(m[t])||(m[t]=r[t])}),r.momentToDate=function(t){return e.isDefined(t)&&t.isValid()?t.clone().toDate():void 0},r.valueUpdate=function(){r.disabled||(r.value=r.momentToDate(r.valueMoment))},r.limits={isAfterOrEqualMin:function(t,i){return!e.isDefined(r.minDateMoment)||t.isAfter(r.minDateMoment,i)||t.isSame(r.minDateMoment,i)},isBeforeOrEqualMax:function(t,i){return!e.isDefined(r.maxDateMoment)||t.isBefore(r.maxDateMoment,i)||t.isSame(r.maxDateMoment,i)},isSelectable:function(e,t){return r.limits.isAfterOrEqualMin(e,t)&&r.limits.isBeforeOrEqualMax(e,t)},checkValue:function(){e.isDefined(r.valueMoment)&&(r.limits.isAfterOrEqualMin(r.valueMoment)||r.valueUpdate(r.valueMoment=r.minDateMoment.clone()),r.limits.isBeforeOrEqualMax(r.valueMoment)||r.valueUpdate(r.valueMoment=r.maxDateMoment.clone()))},checkView:function(){e.isDefined(r.view.moment)||(r.view.moment=moment().locale(r.locale)),r.limits.isAfterOrEqualMin(r.view.moment)||(r.view.moment=r.minDateMoment.clone()),r.limits.isBeforeOrEqualMax(r.view.moment)||(r.view.moment=r.maxDateMoment.clone()),r.view.update()}},r.views={all:["month"],formats:{month:"[Dd]{1,4}(?![Ddo])|DDDo|[Dd]o|[Ww]{1,2}(?![Wwo])|[Ww]o|[Ee]|L{1,2}(?!T)|l{1,2}"}},r.view={isOpen:!1,selected:r.startView,update:function(){r.view.value=r.momentToDate(r.view.moment)},toggle:function(){r.view.isOpen?r.view.close():r.view.open()},open:function(){e.forEach(o[0].querySelectorAll(".moment-picker-container.open"),function(t){((e.element(t).scope().view||{}).close||e.noop)()}),r.disabled||(r.view.isOpen=!0),t(r.view.position,0,!1)},close:function(){r.view.isOpen=!1,r.view.selected=r.startView},position:function(){r.picker.removeClass("top").removeClass("left");var e=r.container[0],t=s(e),i=t.top-a.pageYOffset,n=t.left-a.pageXOffset,o=a.innerWidth,l=a.innerHeight;i+a.pageYOffset-e.offsetHeight>0&&i>l/2&&r.picker.addClass("top"),n+e.offsetWidth>o&&r.picker.addClass("left")},unit:function(){return"decade"==r.view.selected?10:1},precision:function(){return r.view.selected.replace("decade","year")},title:"",previous:{label:i.trustAsHtml(r.leftArrow),selectable:!0,set:function(){r.view.previous.selectable&&r.view.update(r.view.moment.subtract(r.view.unit(),r.view.precision()).toDate())}},next:{selectable:!0,label:i.trustAsHtml(r.rightArrow),set:function(){r.view.next.selectable&&r.view.update(r.view.moment.add(r.view.unit(),r.view.precision()).toDate())}},setParentView:function(){r.view.change(r.views.all[Math.max(0,r.views.all.indexOf(r.view.selected)-1)])},render:function(){var e=r.view.moment.clone().startOf(r.view.precision()).subtract(r.view.unit(),r.view.precision()),t=r.view.moment.clone().endOf(r.view.precision()).add(r.view.unit(),r.view.precision());r.view.previous.selectable=r.limits.isAfterOrEqualMin(e,r.view.precision()),r.view.previous.label=i.trustAsHtml(r.view.previous.selectable?r.leftArrow:"&nbsp;"),r.view.next.selectable=r.limits.isBeforeOrEqualMax(t,r.view.precision()),r.view.next.label=i.trustAsHtml(r.view.next.selectable?r.rightArrow:"&nbsp;"),r.view.title=r[r.view.selected+"View"].render()},change:function(e){var t=r.views.all.indexOf(e),i=r.views.all.indexOf(r.minView),n=r.views.all.indexOf(r.maxView);0>t||t>n?(r.valueUpdate(r.valueMoment=r.view.moment.clone()),r.autoclose&&r.view.close()):t>=i&&(r.view.selected=e)}},r.monthView={days:function(){for(var e=[],t=moment().locale(r.locale).startOf("week"),i=0;7>i;i++)e.push(t.format("dd")),t.add(1,"days");return e}(),weeks:[],render:function(){var t=r.view.moment.month(),i=r.view.moment.clone().startOf("month").startOf("week"),n={},o=i.week(),a=o+5;r.monthView.weeks=[];for(var s=o;a>=s;s++)n[s]="0000000".split("").map(function(){var e=r.limits.isSelectable(i,"day"),n={label:i.format(l.daysFormat),year:i.year(),date:i.date(),month:i.month(),"class":[r.today&&i.isSame(new Date,"day")?"today":"",e&&i.month()==t?i.isSame(r.valueMoment,"day")?"selected":"":"disabled"].join(" ").trim(),selectable:e};return i.add(1,"days"),n});return e.forEach(n,function(e){r.monthView.weeks.push(e)}),r.view.moment.format("MMMM YYYY")},setDate:function(e){e.selectable&&(r.view.update(r.view.moment.year(e.year).month(e.month).date(e.date)),r.view.change("day"))}},r.picker=e.element('<span class="moment-picker"></span>'),c.after(r.picker),r.contents=c.addClass("moment-picker-contents").removeAttr("moment-picker"),r.container=n(r.template)(r),r.picker.append(r.contents),r.picker.append(r.container),r.limits.checkView(),r.$watch("model",function(t){e.isDefined(t)&&(r.valueMoment=moment(t,r.format,r.locale),r.valueMoment.isValid()?(r.view.moment=r.valueMoment.clone(),r.view.update()):r.valueMoment=void 0),r.valueUpdate(r.valueMoment),r.limits.checkValue()}),r.$watch("value",function(){if(e.isDefined(r.valueMoment)){var i=r.model,n=r.valueMoment.format(r.format);n!=i&&t(function(){r.view.update(r.view.moment=r.valueMoment.clone()),r.model=n,e.isFunction(r.change)&&t(function(){r.change({newValue:n,oldValue:i})},0,!1)})}}),r.$watch("[view.selected, view.value]",r.view.render,!0),r.$watch("[minDate, maxDate]",function(){e.forEach(["minDate","maxDate"],function(t){e.isDefined(r[t])&&(r[t+"Moment"]=moment(r[t],r.format,r.locale),r[t+"Moment"].isValid()||(r[t+"Moment"]=void 0))}),r.limits.checkValue(),r.limits.checkView(),r.view.render()},!0),o.on("click",function(){r.view.isOpen&&t(r.view.close)}),r.container.on("click",function(e){e.stopPropagation()}),r.contents.on("click",function(e){e.stopPropagation(),r.view.isOpen||t(r.view.open)}),e.element(r.contents[0].querySelector("input")).on("focus",function(){r.view.isOpen||t(r.view.open)}),e.element(a).on("resize",r.view.position)},r}();e.module("moment-picker",[]).provider("momentPicker",[function(){return new s}]).directive("momentPicker",["$timeout","$sce","$compile","$document","$window","momentPicker",function(e,t,i,n,o,a){return new r(e,t,i,n,o,a)}])}(window.angular);